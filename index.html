<!DOCTYPE html>
<html>
<head><meta charset="utf-8"></head>
<body>
  <script>
    window.addEventListener("message", (e) => {
      // 1. Проверяем, что Glide прислал данные
      if (e.data.type === "run") {
        console.log("Данные получены:", e.data.body.values);
        
        const { p1, p2 } = e.data.body.values;
        
        // 2. Логика поиска
        const text = (p1 || "").toString().toLowerCase();
        const search = (p2 || "").toString().toLowerCase().trim();
        const result = search === "" ? false : text.includes(search);

        // 3. ОТПРАВЛЯЕМ ОТВЕТ (Это уберет кружок загрузки)
        // Важно: используем e.source.postMessage
        e.source.postMessage({ 
          type: "result", 
          body: result 
        }, e.origin);
        
        console.log("Результат отправлен:", result);
      }
    });
  </script>
</body>
</html>
