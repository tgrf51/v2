<!DOCTYPE html>
<html>
<head><meta charset="utf-8"></head>
<body>
  <script>
    // Эта функция — аналог convertDateToString из вашего кода
    function formatResult(res) {
      if (res instanceof Date) return res.toISOString();
      return res;
    }

    window.addEventListener("message", (e) => {
      if (e.data.type === "run") {
        // Получаем значения p1 и p2
        const p1 = (e.data.body.values.p1 || "").toString().toLowerCase();
        const p2 = (e.data.body.values.p2 || "").toString().toLowerCase().trim();

        // Логика поиска (вместо eval из оригинала, делаем конкретную задачу)
        const isFound = p1.includes(p2);

        // Отправляем результат обратно в Glide
        // Если мы это не отправим — будет вечная загрузка!
        e.source.postMessage({ 
          type: "result", 
          body: formatResult(isFound) 
        }, e.origin);
      }
    });
  </script>
</body>
</html>
