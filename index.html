<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
</head>
<body>
    <script>
        window.addEventListener("message", (e) => {
            // Проверяем, что Glide прислал команду на запуск
            if (e.data.type === "run") {
                const values = e.data.body.values;
                
                // Извлекаем p1 и p2
                const metadata = (values.p1 || "").toString().toLowerCase();
                const query = (values.p2 || "").toString().toLowerCase().trim();
                
                // Простая логика поиска: есть ли запрос в тексте
                let result = false;
                if (query !== "") {
                    result = metadata.includes(query);
                }

                // ВАЖНО: Это сообщение останавливает "крутилку" в Glide
                e.source.postMessage({ 
                    type: "result", 
                    body: result 
                }, e.origin);
            }
        });
    </script>
</body>
</html>
